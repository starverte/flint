language: php
php:
- '7'
- '5.6'
- '5.5'
env:
- WP_VERSION=master WP_MULTISITE=0
- WP_VERSION=master WP_MULTISITE=1
- WP_VERSION=4.4
- WP_VERSION=4.3
matrix:
  allow_failures:
  - env: WP_VERSION=4.3
  - env: WP_VERSION=4.4
  fast_finish: true
install:
- npm install
- composer install
- grunt init
before_script:
- mkdir -p /tmp/wordpress
- git clone --depth=1 --branch="$WP_VERSION" git://develop.git.wordpress.org/ /tmp/wordpress/
- theme_slug=$(basename $(pwd))
- theme_dir=/tmp/wordpress/src/wp-content/themes/$theme_slug
- cd ..
- mv $theme_slug $theme_dir
- cd /tmp/wordpress
- echo /tmp/wordpress
- cp wp-tests-config-sample.php wp-tests-config.php
- sed -i "s/youremptytestdbnamehere/wordpress_test/" wp-tests-config.php
- sed -i "s/yourusernamehere/root/" wp-tests-config.php
- sed -i "s/yourpasswordhere//" wp-tests-config.php
- mysql -e 'CREATE DATABASE wordpress_test;' -uroot
- cd $theme_dir
- phpenv rehash
script:
- find . \( -name '*.php' \) -exec php -lf {} \;
- npm test
notifications:
  email: false
  slack:
    secure: mS0AtQDBMEP2FaA67SxNkLetpcdnyJNKfW9OFT8Zn6Q+fW7k26+e2lYbzPLRugNjU/4ERskQVvfMmlOFzxP3mMZNQVGpSiloYwRwMdjw8duxCDa32mu//q2rP6nKoBR/tWu9SiX0YD39BmBBaXf8XA/mQp0oQXEPYtK7U8p2sFs=
sudo: false
